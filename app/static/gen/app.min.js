var jrvs=jrvs||{};(function(){'use strict';jrvs.layout=function(){$('.gridster ul').gridster({widget_margins:[5,5],widget_base_dimensions:[145,145]});};jrvs.dispatch=function(){var source=new EventSource('/events');source.addEventListener('message',function(message){var o=JSON.parse(message.data);if(typeof o==='object'&&Object.keys(o.body).length>0){var el=document.getElementById(o.widget);if(el===null){return;}
o.body.updatedAt=moment().format('HH:mm');var event=new CustomEvent(o.widget,{'detail':o.body});el.dispatchEvent(event);}},false);};jrvs.truncate=function(s,n){if(s.length>n){return s.substring(0,n)+'...';}
return s;};document.addEventListener('DOMContentLoaded',function(){jrvs.layout();jrvs.dispatch();});})();(function(){'use strict';var ping={'el':document.getElementById('ping')};ping.controller=function(){var ctrl=this;ctrl.data={};ping.el.addEventListener('ping',function(event){ctrl.data=event.detail;m.render(ping.el,ping.view(ctrl));});};ping.view=function(ctrl){if(Object.keys(ctrl.data).length===0){return m('p','Waiting for data');}
return[m('div#y-axis'),m('div#chart',{'config':function(element,isInitialized){if(isInitialized){ping.graph.series.addData(ctrl.data.values);}else{ping.graph=ping.createGraph(element,ctrl.data.values);}
ping.graph.render();}}),m('div#legend')];};ping.createGraph=function(element,values){var labels=Object.keys(values).map(function(name){return{name:name};});var series=new Rickshaw.Series.FixedDuration(labels,new Rickshaw.Color.Palette({scheme:'colorwheel'}),{timeInterval:5000,maxDataPoints:100,timeBase:new Date().getTime()/1000});var graph=new Rickshaw.Graph({element:element,width:535,height:240,renderer:'line',stroke:true,unstack:true,series:series});new Rickshaw.Graph.Legend({element:document.querySelector('#legend'),graph:graph});new Rickshaw.Graph.Axis.Y({element:document.querySelector('#y-axis'),graph:graph,orientation:'left',ticks:5,tickFormat:function(n){return n+' ms';}});return graph;};if(ping.el!==null){m.module(ping.el,ping);}})();(function(){'use strict';var stats={'el':document.getElementById('stats')};stats.controller=function(){var ctrl=this;ctrl.data={};stats.el.addEventListener('stats',function(event){ctrl.data=event.detail;m.render(stats.el,stats.view(ctrl));});};stats.view=function(c){if(Object.keys(c.data).length===0){return m('p','Waiting for data');}
return[m('h1','Dagens forbruk'),m('table',[m('tr.fade',[m('th','Drikke'),m('th','Antall')]),m('tr',[m('td','Kaffe'),m('td',[m('span',c.data.stats.coffee),m('span.fade',' / '+c.data.max.coffee)])]),m('tr',[m('td','Øl'),m('td',[m('span',c.data.stats.beer),m('span.fade',' / '+c.data.max.beer)])])]),m('p',{'class':'fade updated-at'},'Sist oppdatert: '+
c.data.updatedAt)];};if(stats.el!==null){m.module(stats.el,stats);}})();(function(){'use strict';var time={'el':document.getElementById('time')};time.controller=function(){var ctrl=this;ctrl.now=moment().lang('nb');var setTime=function(){ctrl.now=moment().lang('nb');m.render(time.el,time.view(ctrl));};setInterval(setTime,500);};time.view=function(ctrl){return[m('h1',ctrl.now.format('HH:mm')),m('h2',ctrl.now.format('dddd')),m('p',ctrl.now.format('D. MMMM YYYY'))];};if(time.el!==null){m.module(time.el,time);}})();(function(){'use strict';var uptime={'el':document.getElementById('uptime')};uptime.controller=function(){var ctrl=this;ctrl.data={};uptime.el.addEventListener('uptime',function(event){var body=event.detail;body.hosts.forEach(function(host){host.active=host.active?'aktiv':'inaktiv';});ctrl.data=body;m.render(uptime.el,uptime.view(ctrl));});};uptime.view=function(c){if(Object.keys(c.data).length===0){return m('p','Waiting for data');}
var rows=c.data.hosts.map(function(host){return m('tr',[m('td.label',host.label),m('td.active',host.active)]);});return[m('p.fade','Enheter'),m('table',rows),m('p',{'class':'fade updated-at'},'Sist oppdatert: '+
c.data.updatedAt)];};if(uptime.el!==null){m.module(uptime.el,uptime);}})();(function(){'use strict';var yr={'el':document.getElementById('yr')};yr.controller=function(){var ctrl=this;ctrl.data={};yr.el.addEventListener('yr',function(event){ctrl.data=event.detail;m.render(yr.el,yr.view(ctrl));});};yr.view=function(ctrl){if(Object.keys(ctrl.data).length===0){return m('p','Waiting for data');}
return[m('p.fade','Været i '+ctrl.data.today.location),m('h1',ctrl.data.today.temperature+'°'),m('p',ctrl.data.today.description),m('p.wind',ctrl.data.today.wind.description+' ('+
ctrl.data.today.wind.speed+' m/s) fra '+
ctrl.data.today.wind.direction.toLowerCase()),m('p.tomorrow','I morgen: '+ctrl.data.tomorrow.temperature+'° ('+ctrl.data.tomorrow.description.toLowerCase()+')'),m('p',{'class':'fade updated-at'},'Sist oppdatert: '+
ctrl.data.updatedAt)];};if(yr.el!==null){m.module(yr.el,yr);}})();(function(){'use strict';var deadlines={'el':document.getElementById('deadlines')};deadlines.controller=function(){var ctrl=this;ctrl.data={};deadlines.el.addEventListener('deadlines',function(event){var body=event.detail;if(body.events.length===0){return;}
body.events.forEach(function(e){e.date=moment(e.date).lang('nb');});var eventDate=body.events[0].date,now=moment();if(eventDate.isBefore(now)||eventDate.isSame(now,'day')){body.today=body.events.shift()||null;}else{body.today=null;}
var lines=Math.floor(((deadlines.el.parentNode.getAttribute("data-sizey")-2)*155)/20)
body.events=body.events.slice(0,4+lines);ctrl.data=body;m.render(deadlines.el,deadlines.view(ctrl));});};deadlines.view=function(c){if(Object.keys(c.data).length===0){return m('p','Waiting for data');}
var rows=c.data.events.map(function(event){return m('tr',[m('td',{'class':'fade summary'},jrvs.truncate(event.summary,19)),m('td.start',event.date.format('DD. MM HH:mm'))]);});return[m('p.fade','Deadlines:'),m('h1',c.data.today?c.data.today.date.format('HH:mm'):'--:--'),m('h2',c.data.today?jrvs.truncate(c.data.today.summary,20):'Kommende deadlines!'),m('table',rows),m('p',{'class':'fade updated-at'},'Sist oppdatert: '+
c.data.updatedAt)];};if(deadlines.el!==null){m.module(deadlines.el,deadlines);}})();(function(){'use strict';var creativiascene={'el':document.getElementById('creativiascene')};creativiascene.controller=function(){var ctrl=this;ctrl.data={};creativiascene.el.addEventListener('creativiascene',function(event){var body=event.detail;if(body.events.length===0){return;}
body.events.forEach(function(e){e.date=moment(e.date).lang('nb');});var eventDate=body.events[0].date,now=moment();if(eventDate.isBefore(now)||eventDate.isSame(now,'day')){body.today=body.events.shift()||null;}else{body.today=null;}
var lines=Math.floor(((creativiascene.el.parentNode.getAttribute("data-sizey")-2)*155)/20)
body.events=body.events.slice(0,4+lines);ctrl.data=body;m.render(creativiascene.el,creativiascene.view(ctrl));});};creativiascene.view=function(c){if(Object.keys(c.data).length===0){return m('p','Waiting for data');}
var rows=c.data.events.map(function(event){return m('tr',[m('td',{'class':'fade summary'},jrvs.truncate(event.summary,19)),m('td.start',event.date.format('DD. MM HH:mm'))]);});return[m('p.fade','Creativia Scena:'),m('h1',c.data.today?c.data.today.date.format('HH:mm'):'--:--'),m('h2',c.data.today?jrvs.truncate(c.data.today.summary,20):'Ingenting skjer!'),m('table',rows),m('p',{'class':'fade updated-at'},'Sist oppdatert: '+
c.data.updatedAt)];};if(creativiascene.el!==null){m.module(creativiascene.el,creativiascene);}})();(function(){'use strict';var kiosk={'el':document.getElementById('kiosk')};})();var prevKiosk;clearKiosk();var impKiosk=impress("kiosk");var impressKiosk;var rKiosk=0;function clearKiosk()
{$.ajax({method:'GET',crossDomain:true,url:'http://localhost:5000/kiosk',success:function(data,status,xhr){var d=JSON.parse(data);var html='';$(d.data).each(function(i){html+='<div class="step" data-y="'+i*2000+'">'+d.data[i].content+'</div>';if(i==d.data.length-1){html+='<div class="step laststep" data-y="'+(i+1)*2000+'">'+d.data[0].content+'</div>';}});if(html!=prevKiosk){prevKiosk=html;$('#kiosk').empty();$('#kiosk').append(html);impressKiosk=impKiosk;impressKiosk.init();impressKiosk.goto(0,0);}},error:function(xhr,status,error){console.log(status.text);}});}
document.addEventListener('impress:stepenter',function(e){if($(e.target).hasClass('laststep')){rKiosk++;if(rKiosk%2==1)
{clearKiosk();}}
if(typeof timing!=='undefined')clearInterval(timing);var duration=(e.target.getAttribute('data-transition-duration')?e.target.getAttribute('data-transition-duration'):2000);timing=setInterval(impressKiosk.next,duration);});var prevMentors;clearImpressMentors();var impMentors=impress("mentorer");var impressMentors;var rMentors=0;function clearImpressMentors()
{$.ajax({method:'GET',crossDomain:true,url:'http://localhost:5000/mentorer',success:function(data,status,xhr){var d=JSON.parse(data);var html='';$(d.data).each(function(i){html+='<div class="step" data-y="'+i*2000+'">'+d.data[i].content+'</div>';if(i==d.data.length-1){html+='<div class="step laststep" data-y="'+(i+1)*2000+'">'+d.data[0].content+'</div>';}});if(html!=prevMentors){prevMentors=html;$('#mentorer').empty();$('#mentorer').append(html);impressMentors=impMentors;impressMentors.init();impressMentors.goto(0,0);}},error:function(xhr,status,error){console.log(status.text);}});}
document.addEventListener('impress:stepenter',function(e){if($(e.target).hasClass('laststep')){rMentors++;if(rMentors%2==1)
{clearImpressMentors();}}
if(typeof timing!=='undefined')clearInterval(timing);var duration=(e.target.getAttribute('data-transition-duration')?e.target.getAttribute('data-transition-duration'):2000);timing=setInterval(impressMentors.next,duration);});